#!/bin/bash -e

echo "▶ Iniciando docker-entrypoint..."

# Asegurar que DATABASE_URL existe
if [ -z "$DATABASE_URL" ]; then
  echo "❌ ERROR: DATABASE_URL no está seteada"
  exit 1
fi

echo "▶ DATABASE_URL detectada correctamente"

# Preparar DB solamente si existe (Rails manejará migraciones)
echo "▶ Ejecutando db:prepare..."
bundle exec rails db:prepare || true

echo "▶ Iniciando Puma..."
exec "$@"
